!function(){"use strict";angular.module("jackblog.service",[])}(),function(){"use strict";angular.module("jackblog.service").factory("CustomModalService",["$modal",function(t){return{open:function(e,a,n){t.open({templateUrl:a,controller:e,size:n})}}}])}(),function(){"use strict";angular.module("jackblog.service").factory("Auth",["$location","$rootScope","$http","User","$cookies","$q","lodash","$window","ServerUrl","CookieConfig",function(t,e,a,n,o,i,l,s,r,c){var d={};return o.get("token")&&(d=n.get()),{login:function(t,e){var l=e||angular.noop,s=i.defer();return a.post(r+"/auth/local",{email:t.email,password:t.password,captcha:t.captcha}).success(function(t){return o.put("token",t.token,c),d=n.get(),s.resolve(t),l()}).error(function(t){return this.logout(),s.reject(t),l(t)}.bind(this)),s.promise},snsLogin:function(t,e){var a=r+"/auth/"+t+"?redirectUrl="+(e||"/");o.get("token")&&(a+="&access_token="+o.get("token").replace(/(^\")|(\"$)/g,"")),s.location.href=a},logout:function(){o.remove("token",c),d={}},getCurrentUser:function(){return d},isLoggedIn:function(){return d.hasOwnProperty("role")},isLoggedInAsync:function(t){d.hasOwnProperty("$promise")?d.$promise.then(function(){t(!0)})["catch"](function(){t(!1)}):t(d.hasOwnProperty("role")?!0:!1)},isLike:function(t){var e=l.findIndex(d.likes,function(e){return e.toString()===t});return e!==-1},isAdmin:function(){return"admin"===d.role},getToken:function(){return o.get("token")}}}])}(),function(){"use strict";angular.module("jackblog.service").factory("AuthInterceptor",["$rootScope","$q","$cookies","$location","$injector",function(t,e,a,n,o){var i;return{request:function(t){return t.headers=t.headers||{},a.get("token")&&(t.headers.Authorization="Bearer "+a.get("token").replace(/(^\")|(\"$)/g,"")),t},response:function(t){return t},responseError:function(t){return 401===t.status?(i=o.get("Auth"),i.logout(),n.path("/signin"),e.reject(t)):e.reject(t)}}}])}(),function(){"use strict";angular.module("jackblog.resources",["ngResource"])}(),function(){"use strict";angular.module("jackblog.resources").factory("User",["$resource","ServerUrl",function(t,e){var a=t(e+"/users/:id/:controller",{id:"@_id"},{getUserList:{method:"GET",params:{id:"getUserList"}},addUser:{method:"POST",params:{id:"addUser"}},updateUser:{method:"PUT",params:{controller:"updateUser"}},getCaptcha:{method:"GET",params:{id:"getCaptcha"}},get:{method:"GET",params:{id:"me"}},mdUser:{method:"PUT",params:{id:"mdUser"}},getUserProvider:{method:"GET",params:{id:"getUserProvider"}},snsLogins:{method:"GET",params:{id:"snsLogins"}}});return{getUserList:function(t,e){var n=e||angular.noop;return a.getUserList(t,function(t){return n(t)},function(t){return n(t)}).$promise},addUser:function(t,e){var n=e||angular.noop;return a.addUser(t,function(t){return n(t)},function(t){return n(t)}).$promise},deleteUser:function(t,e){var n=e||angular.noop;return a.remove(t,function(t){return n(t)},function(t){return n(t)}).$promise},updateUser:function(t,e,n){var o=n||angular.noop;return a.updateUser({id:t},e,function(t){return o(t)},function(t){return o(t)}).$promise},get:a.get,getCaptcha:function(t){var e=t||angular.noop;return a.getCaptcha(function(t){return e(t)},function(t){return e(t)}).$promise},mdUser:function(t,e){var n=e||angular.noop;return a.mdUser(t,function(t){return n(t)},function(t){return n(t)}).$promise},getUserProvider:function(t){var e=t||angular.noop;return a.getUserProvider(function(t){return e(t)},function(t){return e(t)}).$promise},getLogins:function(t){var e=t||angular.noop;return a.snsLogins(function(t){return e(t)},function(t){return e(t)}).$promise}}}])}(),function(){"use strict";angular.module("jackblog.resources").factory("Tags",["$resource","ServerUrl",function(t,e){var a=t(e+"/tags/:id/:controller",{id:"@_id"},{addTagCat:{method:"POST",params:{id:"addTagCat"}},getTagCatList:{method:"GET",params:{id:"getTagCatList"}},updateTagCat:{method:"PUT",params:{controller:"updateTagCat"}},getTagList:{method:"GET",params:{controller:"getTagList"}},addTag:{method:"POST",params:{id:"addTag"}},deleteTag:{method:"DELETE",params:{controller:"deleteTag"}},updateTag:{method:"PUT",params:{controller:"updateTag"}},getFrontTagList:{method:"GET",params:{id:"getFrontTagList"}}});return{addTagCat:function(t,e){var n=e||angular.noop;return a.addTagCat(t,function(t){return n(t)},function(t){return n(t)}).$promise},getTagCatList:function(t){var e=t||angular.noop;return a.getTagCatList(function(t){return e(t)},function(t){return e(t)}).$promise},updateTagCat:function(t,e,n){var o=n||angular.noop;return a.updateTagCat({id:t},e,function(t){return o(t)},function(t){return o(t)}).$promise},deleteCat:function(t,e){var n=e||angular.noop;return a.remove(t,function(t){return n(t)},function(t){return n(t)}).$promise},getTagList:function(t,e){var n=e||angular.noop;return a.getTagList(t,function(t){return n(t)},function(t){return n(t)}).$promise},addTag:function(t,e){var n=e||angular.noop;return a.addTag(t,function(t){return n(t)},function(t){return n(t)}).$promise},deleteTag:function(t,e){var n=e||angular.noop;return a.deleteTag(t,function(t){return n(t)},function(t){return n(t)}).$promise},updateTag:function(t,e,n){var o=n||angular.noop;return a.updateTag({id:t},e,function(t){return o(t)},function(t){return o(t)}).$promise},getFrontTagList:function(t){var e=t||angular.noop;return a.getFrontTagList(function(t){return e(t)},function(t){return e(t)}).$promise}}}])}(),function(){"use strict";angular.module("jackblog.resources").factory("Mobile",["$resource","ServerUrl",function(t,e){var a=t(e+"/mobile/:id/:controller",{id:"@_id"},{getApps:{method:"GET",params:{id:"getApps"}}});return{getApps:function(t){var e=t||angular.noop;return a.getApps(function(t){return e(t)},function(t){return e(t)}).$promise}}}])}(),function(){"use strict";angular.module("jackblog.resources").factory("Comment",["$resource","ServerUrl",function(t,e){var a=t(e+"/comment/:id/:controller",{id:"@_id"},{getFrontCommentList:{method:"GET",params:{controller:"getFrontCommentList"}},addNewComment:{method:"POST",params:{id:"addNewComment"}},addNewReply:{method:"POST",params:{controller:"addNewReply"}},delReply:{method:"PUT",params:{controller:"delReply"}}});return{addNewComment:function(t,e){var n=e||angular.noop;return a.addNewComment(t,function(t){return n(t)},function(t){return n(t)}).$promise},getFrontCommentList:function(t,e){var n=e||angular.noop;return a.getFrontCommentList(t,function(t){return n(t)},function(t){return n(t)}).$promise},addNewReply:function(t,e,n){var o=n||angular.noop;return a.addNewReply({id:t},e,function(t){return o(t)},function(t){return o(t)}).$promise},delComment:function(t,e){var n=e||angular.noop;return a.remove(t,function(t){return n(t)},function(t){return n(t)}).$promise},delReply:function(t,e,n){var o=n||angular.noop;return a.delReply({id:t},e,function(t){return o(t)},function(t){return o(t)}).$promise}}}])}(),function(){"use strict";angular.module("jackblog.resources").factory("Blog",["$resource","ServerUrl",function(t,e){var a=t(e+"/article/:id/:controller",{id:"@_id"},{addBlog:{method:"POST",params:{id:"addArticle"}},getBlogList:{method:"GET",params:{id:"getArticleList"}},updateBlog:{method:"PUT",params:{controller:"updateArticle"}},getBlog:{method:"GET",params:{controller:"getArticle"}},fetchImage:{method:"POST",params:{id:"fetchImage"}},getFrontBlogList:{method:"GET",params:{id:"getFrontArticleList"}},getFrontBlogCount:{method:"GET",params:{id:"getFrontArticleCount"}},getFrontArticle:{method:"GET",params:{controller:"getFrontArticle"}},getIndexImage:{method:"GET",params:{id:"getIndexImage"}},toggleLike:{method:"PUT",params:{controller:"toggleLike"}},getPrenext:{method:"GET",params:{controller:"getPrenext"}}});return{addBlog:function(t,e){var n=e||angular.noop;return a.addBlog(t,function(t){return n(t)},function(t){return n(t)}).$promise},getBlogList:function(t,e){var n=e||angular.noop;return a.getBlogList(t,function(t){return n(t)},function(t){return n(t)}).$promise},updateBlog:function(t,e,n){var o=n||angular.noop;return a.updateBlog({id:t},e,function(t){return o(t)},function(t){return o(t)}).$promise},deleteBlog:function(t,e){var n=e||angular.noop;return a.remove(t,function(t){return n(t)},function(t){return n(t)}).$promise},getBlog:function(t,e){var n=e||angular.noop;return a.getBlog(t,function(t){return n(t)},function(t){return n(t)}).$promise},fetchImage:function(t,e){var n=e||angular.noop;return a.fetchImage(t,function(t){return n(t)},function(t){return n(t)}).$promise},getFrontBlogList:function(t,e){var n=e||angular.noop;return a.getFrontBlogList(t,function(t){return n(t)},function(t){return n(t)}).$promise},getFrontBlogCount:function(t,e){var n=e||angular.noop;return a.getFrontBlogCount(t,function(t){return n(t)},function(t){return n(t)}).$promise},getFrontArticle:function(t,e){var n=e||angular.noop;return a.getFrontArticle(t,function(t){return n(t)},function(t){return n(t)}).$promise},getIndexImage:function(t){var e=t||angular.noop;return a.getIndexImage(function(t){return e(t)},function(t){return e(t)}).$promise},toggleLike:function(t,e){var n=e||angular.noop;return a.toggleLike(t,{},function(t){return n(t)},function(t){return n(t)}).$promise},getPrenext:function(t,e){var n=e||angular.noop;return a.getPrenext(t,function(t){return n(t)},function(t){return n(t)}).$promise}}}])}(),function(){"use strict";angular.module("jackblog",["ngAnimate","ngCookies","ngTouch","ngSanitize","ui.router","ui.bootstrap","ngLodash","ngProgress","toaster","ngFileUpload","jackblog.resources","jackblog.service","jackblog.filter","jackblog.directives","jackblog.manage","jackblog.article","jackblog.settings"]).config(["$logProvider","$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider","IsDebug",function(t,e,a,n,o,i){n.html5Mode(!0),o.defaults.timeout=5e5,o.defaults.withCredentials=!0,o.interceptors.push("AuthInterceptor"),t.debugEnabled(i),a.otherwise("/blog_list")}]).run(["$rootScope","ngProgressFactory","$state","lodash","Auth","Blog","$cookies","CustomModalService","toaster","CookieConfig",function(t,e,a,n,o,i,l,s,r,c){t.default_avatar="/assets/images/avatar.png",t.opneSnsModal=function(){s.open("SnsSignInCtrl","app/settings/sns_sign_in.html")},t.progressbar=e.createInstance();var d=["/signin","/signup"],u=function(t){return n.find(d,function(e){return n.startsWith(t,e)})};t.$on("$stateChangeStart",function(e,n){t.progressbar.setColor("green"),t.progressbar.reset(),t.progressbar.start(),o.isLoggedInAsync(function(t){u(n.url)&&t&&(e.preventDefault(),a.go("blogList")),u(n.url)||o.isAdmin()||(e.preventDefault(),o.logout(),a.go("signin"))})}),t.$on("$stateChangeSuccess",function(e,a,n,o,i){t.progressbar.complete(),t.previousState=o,t.previousParams=i}),t.$on("$locationChangeSuccess",function(e,a,n){t.currentUrl=a,t.previousUrl=n;var o=l.get("snsmsg");o&&(o=JSON.parse(o),r.pop(o.msgtype,"",o.msg),l.remove("snsmsg",c))}),t.$on("$stateChangeError",function(){t.progressbar.reset()})}])}(),function(){"use strict";angular.module("jackblog").controller("FooterCtrl",["$scope",function(t){t.beian="©2015 / 鄂ICP备15010989号-1"}])}(),function(){"use strict";angular.module("jackblog").controller("NavbarCtrl",["$rootScope","$scope","$state","$location","Auth","lodash",function(t,e,a,n,o,i){e.isLoggedIn=o.isLoggedIn,e.isAdmin=o.isAdmin,e.getCurrentUser=o.getCurrentUser,e.logout=function(){o.logout(),a.go("signin",{},{reload:!0})},e.changeMode=function(){t.dayMode=!t.dayMode},e.isActive=function(t){return"/"===t?"/apps"!==n.path():i.startsWith(n.path(),t)}}])}(),function(){"use strict";angular.module("jackblog.directives",[])}(),function(){"use strict";angular.module("jackblog.directives").directive("email",function(){return{require:["ngModel","^?form"],link:function(t,e,a,n){var o=/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/;n[0].$parsers.unshift(function(t){return o.test(t)?(n[0].$setValidity("email",!0),t):void n[0].$setValidity("email",!1)})}}}).directive("nickname",function(){return{require:"ngModel",link:function(t,e,a,n){var o=/^[(\u4e00-\u9fa5)0-9a-zA-Z\_\s@]+$/;n.$parsers.unshift(function(t){return o.test(t)?(n.$setValidity("nickname",!0),t):void n.$setValidity("nickname",!1)})}}})}(),function(){"use strict";angular.module("jackblog.directives").directive("scrolltop",["$window",function(t){return{restrict:"EA",replace:!0,template:'<div class="gotop" ng-show="isShowTop"><i class="fa fa-arrow-up"></i></div>',link:function(e,a,n){e.isShowTop=!1;var o=$("html,body");a.bind("click",function(){0===$(window).scrollTop()||o.is(":animated")||o.animate({scrollTop:0},"slow")}),angular.element(t).bind("scroll",function(){this.pageYOffset>=200?e.isShowTop=!0:e.isShowTop=!1,e.$apply()})}}}])}(),function(){"use strict";angular.module("jackblog.directives").directive("markdowneditor",function(){return{restrict:"A",replace:!1,link:function(t,e,a){var n=window.markdownit();n.toHTML=n.render,window.markdown=n,$(e).markdown({autofocus:!1,savable:!1})}}})}(),function(){"use strict";angular.module("jackblog.filter",[]).filter("userStatus",function(){return function(t){var e;switch(t){case 0:e="未验证";break;case 1:e="已验证";break;case 2:e="被阻止";break;default:e="未知状态"}return e}}).filter("customTime",function(){var t=(new Date).getTime(),e=6e4,a=60*e,n=24*a,o=30*n,i=12*o;return function(l){var s,r=new Date(l).getTime(),c=parseInt(t)-parseInt(r);return s=c>=i?parseInt(c/i)+"年前":c<i&&c>=o?parseInt(c/o)+"月前":c<o&&c>=n?parseInt(c/n)+"天前":c<n&&c>=a?parseInt(c/a)+"小时前":c<a&&c>=e?parseInt(c/e)+"分钟前":"刚刚"}})}(),function(){"use strict";angular.module("jackblog.settings",[]).config(["$stateProvider",function(t){t.state("signin",{url:"/signin",templateUrl:"app/settings/local_sign_in.html",controller:"LocalSignInCtrl"}).state("setting",{url:"/setting",templateUrl:"app/settings/user_setting.html",controller:"SettingCtrl",onlyUser:!0})}])}(),function(){"use strict";angular.module("jackblog.settings").controller("SettingCtrl",["$scope","User","Auth","toaster","$state",function(t,e,a,n,o){t.user=e.get(),t.mdUser=function(a){a.$valid&&e.mdUser(t.user).then(function(e){t.user=e.data,n.pop("success","","修改资料成功")})["catch"](function(t){t=t.data.error_msg||"修改用户失败",n.pop("error","",t),o.reload()})}}])}(),function(){"use strict";angular.module("jackblog.settings").controller("SnsSignInCtrl",["$rootScope","$scope","Auth",function(t,e,a){e.loginOauth=function(e){a.snsLogin(e,t.currentUrl)}}])}(),function(){"use strict";angular.module("jackblog.settings").directive("snsloginbtns",["$rootScope","User",function(t,e){return{restrict:"E",templateUrl:"app/settings/sns_login_btn.html",replace:!0,link:function(t,a,n){e.getLogins().then(function(e){t.loginBtns=e.data})}}}])}(),function(){"use strict";angular.module("jackblog.settings").controller("LocalSignInCtrl",["$rootScope","$scope","Auth","$state","$log","toaster","$cookies","ServerUrl","CookieConfig",function(t,e,a,n,o,i,l,s,r){function c(){e.captchaUrl=s+"/users/getCaptcha?"+Math.random()}function d(){a.login({email:e.user.email,password:e.user.password,captcha:e.user.captcha}).then(function(){i.pop("success","","登录成功,欢迎光临!"),n.go("blogList")})["catch"](function(t){e.user.captcha="",c(),t=t.error_msg||t.data.error_msg||"登录失败,请重试",i.pop("error","",t),l.remove("token",r)})}e.loginOauth=function(e){a.snsLogin(e,t.previousUrl)},c(),e.changeCaptcha=function(){c()},e.user={},e.login=function(t){t.$valid&&d()},e.loginPress=function(t,e){13===t.which&&e.$valid&&(t.preventDefault(),d())}}])}(),function(){"use strict";angular.module("jackblog.manage",[]).config(["$stateProvider",function(t){t.state("blogWrite",{url:"/blog_write",templateUrl:"app/manage_blog/blog_write.html",controller:"BlogWriteCtrl",onlyAdmin:!0}).state("blogList",{url:"/blog_list",templateUrl:"app/manage_blog/blog_list.html",controller:"BlogListCtrl",onlyAdmin:!0}).state("blogEdit",{url:"/blog_edit/:aid",templateUrl:"app/manage_blog/blog_edit.html",controller:"BlogEditCtrl",onlyAdmin:!0}).state("tagsManage",{url:"/tags_manage",templateUrl:"app/manage_tag/tags_manage.html",controller:"TagsManageCtrl",onlyAdmin:!0}).state("tagsList",{url:"/tags_list/:cid",templateUrl:"app/manage_tag/tags_list.html",controller:"TagsListCtrl",onlyAdmin:!0}).state("userList",{url:"/user_list",templateUrl:"app/manage_user/user_list.html",controller:"UserListCtrl",onlyAdmin:!0})}])}(),function(){"use strict";angular.module("jackblog.manage").controller("UserListCtrl",["$scope","$modal","$state","User","toaster",function(t,e,a,n,o){function i(e){n.getUserList(e,function(e){t.userList=e.data,t.bigTotalItems=e.count},function(e){t.userList=[]})}t.options={currentPage:1,itemsPerPage:10,sortName:"created",sortOrder:!1},t.changeSort=function(e){t.options.sortName===e&&(t.options.sortOrder=!t.options.sortOrder),t.options.sortName=e},t.maxSize=5,t.$watchCollection("options",function(t,e){i(t)}),t.del=function(e){confirm("你确定要删除这个用户吗?")&&n.deleteUser({id:e._id}).then(function(){o.pop("success","","删除用户"+e.nickname+"成功"),i(t.options)})["catch"](function(t){t=t.data.error_msg||"删除用户失败",o.pop("error","",t)})},t.add=function(a){var n=e.open({templateUrl:"app/manage_user/user_add.html",controller:"ModalAddUserCtrl",size:a});n.result.then(function(e){o.pop("success","","添加用户 "+e+" 成功"),i(t.options)})["catch"](function(t){t=t.message||t.data.error_msg||"添加用户失败",o.pop("error","",t)})},t.edit=function(a){var n=e.open({templateUrl:"app/manage_user/user_edit.html",controller:"ModalEditUserCtrl",resolve:{currentUser:function(){return a}}});n.result.then(function(e){o.pop("success","","编辑用户 "+e+" 成功"),i(t.options)})}}]).controller("ModalAddUserCtrl",["$scope","$modalInstance","User","toaster",function(t,e,a,n){t.user={},t.ok=function(o){o.$valid&&a.addUser(t.user).then(function(){e.close(t.user.nickname)})["catch"](function(t){t=t.data.error_msg||"添加用户失败",n.pop("error","",t)})},t.cancel=function(){e.dismiss("cancel")}}]).controller("ModalEditUserCtrl",["$scope","$modalInstance","User","toaster","currentUser",function(t,e,a,n,o){t.currentUser=o,t.ok=function(o){o.$valid&&a.updateUser(t.currentUser._id,t.currentUser).then(function(){e.close(t.currentUser.nickname)})["catch"](function(t){t=t.data.error_msg||"编辑用户失败",n.pop("error","",t)})},t.cancel=function(){e.dismiss("cancel")}}])}(),function(){"use strict";angular.module("jackblog.manage").controller("TagsManageCtrl",["$scope","$modal","Tags","toaster",function(t,e,a,n){a.getTagCatList().then(function(e){t.catList=e.data}),t.del=function(e){confirm("你确定要删除分类?")&&a.deleteCat({id:e._id}).then(function(){n.pop("success","","删除标签"+e.name+"成功")}).then(function(){return a.getTagCatList().then(function(e){t.catList=e.data})})["catch"](function(t){t=t.data.error_msg||"删除标签分类失败.",n.pop("error","",t)})},t.add=function(o){var i=e.open({templateUrl:"app/manage_tag/tag_cat_add.html",controller:"ModalAddTagCatCtrl",size:o});i.result.then(function(){n.pop("success","","添加标签分类成功"),a.getTagCatList().then(function(e){t.catList=e.data})})},t.edit=function(o){var i=e.open({templateUrl:"app/manage_tag/tag_cat_edit.html",controller:"ModalEditTagCatCtrl",resolve:{currentCat:function(){return o}}});i.result.then(function(){n.pop("success","","编辑标签分类成功"),a.getTagCatList().then(function(e){t.catList=e.data})})}}]).controller("ModalAddTagCatCtrl",["$scope","$modalInstance","Tags","toaster",function(t,e,a,n){t.cat={},t.ok=function(o){o.$valid&&a.addTagCat(t.cat).then(function(){e.close()})["catch"](function(t){t=t.data.error_msg||"添加标签分类失败.",n.pop("error","",t)})},t.cancel=function(){e.dismiss("cancel")}}]).controller("ModalEditTagCatCtrl",["$scope","$modalInstance","Tags","toaster","currentCat",function(t,e,a,n,o){t.cat=o,t.ok=function(o){o.$valid&&a.updateTagCat(t.cat._id,t.cat).then(function(){e.close()})["catch"](function(t){t=t.data.error_msg||"修改标签分类失败.",n.pop("error","",t)})},t.cancel=function(){e.dismiss("cancel")}}])}(),function(){"use strict";angular.module("jackblog.manage").controller("TagsListCtrl",["$scope","$modal","$state","$stateParams","Tags","toaster",function(t,e,a,n,o,i){t.cid=n.cid||0,o.getTagList({id:t.cid}).then(function(e){t.tagList=e.data}),o.getTagCatList().then(function(e){t.catList=e.data}),t.changeCat=function(){a.go("tagsList",{cid:t.cid})},t.del=function(e){confirm("你确定要删除标签?")&&o.deleteTag({id:e._id}).then(function(){i.pop("success","","删除标签"+e.name+"成功")}).then(function(){return o.getTagList({id:t.cid}).then(function(e){t.tagList=e.data})})["catch"](function(t){t=t.data.error_msg||"删除标签失败.",i.pop("error","",t)})},t.add=function(a){var n=e.open({templateUrl:"app/manage_tag/tag_add.html",controller:"ModalAddTagCtrl",size:a});n.result.then(function(){i.pop("success","","添加标签成功"),o.getTagList({id:t.cid}).then(function(e){t.tagList=e.data})})},t.edit=function(a){var n=e.open({templateUrl:"app/manage_tag/tag_edit.html",controller:"ModalEditTagCtrl",resolve:{currentTag:function(){return a}}});n.result.then(function(){i.pop("success","","编辑标签成功"),o.getTagList({id:t.cid}).then(function(e){t.tagList=e.data})})}}]).controller("ModalAddTagCtrl",["$scope","$modalInstance","Tags","toaster",function(t,e,a,n){a.getTagCatList().then(function(e){t.catList=e.data}),t.tag={is_show:!1,is_index:!1,sort:1},t.ok=function(o){o.$valid&&a.addTag(t.tag).then(function(){e.close()})["catch"](function(t){t=t.data.error_msg||"添加标签失败.",n.pop("error","",t)})},t.cancel=function(){e.dismiss("cancel")}}]).controller("ModalEditTagCtrl",["$scope","$modalInstance","Tags","toaster","currentTag",function(t,e,a,n,o){t.tag=o,a.getTagCatList().then(function(e){t.catList=e.data}),t.ok=function(o){o.$valid&&(t.tag.cid=t.tag.cid._id,a.updateTag(t.tag._id,t.tag).then(function(){e.close()})["catch"](function(t){t=t.data.error_msg||"更新标签失败.",n.pop("error","",t)}))},t.cancel=function(){e.dismiss("cancel")}}])}(),function(){"use strict";angular.module("jackblog.manage").controller("BlogWriteCtrl",["$scope","$state","Tags","$modal","$log","Blog","lodash","toaster",function(t,e,a,n,o,i,l,s){t.article={tags:{},top:!1,content:""},a.getTagList({id:0}).then(function(e){t.tagList=e.data}),t.addTag=function(e){e&&(t.article.tags[e._id]=e)},t.delTag=function(e){delete t.article.tags[e]},t.save=function(a){t.article.tags=l.keys(t.article.tags),t.article.status=a||0,o.debug(t.article),i.addBlog(t.article).then(function(n){a?(s.pop("success","","保存文章 "+t.article.title+" 并发布成功"),e.go("blogList")):(s.pop("success","","保存文章 "+t.article.title+" 为草稿成功"),e.go("blogEdit",{aid:n.article_id}))})["catch"](function(t){t=t.data.error_msg||"添加文章失败.",s.pop("error","",t)})},t.images=[],t.addImages=function(){var e=n.open({templateUrl:"app/manage_blog/blog_images_add.html",controller:"ModalBlogImagesAddCtrl"});e.result.then(function(e){s.pop("success","","添加图片成功"),t.images.push({url:e})})},t.showUrl=function(e){t.selectImageUrl=e},t.delImage=function(e){t.images.splice(e,1)}}]).controller("ModalBlogImagesAddCtrl",["$scope","$cookies","$timeout","$modalInstance","Upload","Blog","toaster","ServerUrl",function(t,e,a,n,o,i,l,s){t.type="local",t.url="",t.uploadImg=function(a,i){t.f=a,t.errFile=i&&i[0],a&&(a.upload=o.upload({url:s+"/article/uploadImage",data:{file:a},headers:{Authorization:"Bearer "+e.get("token")},withCredentials:!0}),a.upload.then(function(t){a.result=t.data,n.close(t.data.img_url)},function(t){if(t.status>0){var e=t.data.error_msg||"上传图片失败.";l.pop("error","",e)}},function(t){a.progress=Math.min(100,parseInt(100*t.loaded/t.total))}))},t.fetchImg=function(){""!==t.url&&i.fetchImage({url:t.url}).then(function(t){n.close(t.img_url)})["catch"](function(t){t=t.data.error_msg||"抓取图片失败.",l.pop("error","",t)})},t.cancel=function(){n.dismiss("cancel")}}])}(),function(){"use strict";angular.module("jackblog.manage").controller("BlogListCtrl",["$scope","$log","Blog","toaster",function(t,e,a,n){function o(e){a.getBlogList(e).then(function(e){t.blogList=e.data,t.bigTotalItems=e.count})}t.options={currentPage:1,itemsPerPage:15,sortName:"publish_time",sortOrder:!1},t.activities=[5,10,20,40,0],t.changeSort=function(e){t.options.sortName===e&&(t.options.sortOrder=!t.options.sortOrder),t.options.sortName=e},t.maxSize=5,t.$watchCollection("options",function(t,e){o(t)}),t.del=function(e){confirm("你确定要删除这篇博客吗?")&&a.deleteBlog({id:e._id}).then(function(){n.pop("success","","删除文章 "+e.title+" 成功"),o(t.options)})["catch"](function(t){t=t.data.error_msg||"删除失败.",n.pop("error","",t)})}}])}(),function(){"use strict";angular.module("jackblog.manage").controller("BlogEditCtrl",["$scope","$state","Tags","$log","Blog","lodash","$stateParams","toaster","$modal",function(t,e,a,n,o,i,l,s,r){t.aid=l.aid,t.aid||e.go("blogList"),o.getBlog({id:t.aid}).then(function(e){t.article=e.data;var a={};i.map(t.article.tags,function(t){a[t._id]=t}),t.article.tags=a}),a.getTagList({id:0}).then(function(e){t.tagList=e.data}),t.addTag=function(e){e&&(t.article.tags[e._id]=e)},t.delTag=function(e){delete t.article.tags[e]},t.showUrl=function(e){t.selectImageUrl=e},t.delImage=function(e){t.article.images.splice(e,1)},t.addImages=function(){var e=r.open({templateUrl:"app/manage_blog/blog_images_add.html",controller:"ModalBlogImagesAddCtrl"});e.result.then(function(e){s.pop("success","","添加图片成功"),t.article.images.push({url:e})})},t.save=function(a){t.article.tags=i.keys(t.article.tags),a&&(t.article.isRePub=!0),o.updateBlog(t.article._id,t.article).then(function(){s.pop("success","","保存文章 "+t.article.title+" 成功"),e.reload()})["catch"](function(t){t=t.data.error_msg||"保存文章失败.",s.pop("error","",t)})}}])}(),function(){"use strict";angular.module("jackblog.article",[]).config(["$stateProvider",function(t){t.state("article",{url:"/article/:aid",templateUrl:"app/article/article.html",controller:"ArticleCtrl"})}])}(),function(){"use strict";angular.module("jackblog.article").directive("reply",["Comment","$log","toaster",function(t,e,a){return{restrict:"EA",templateUrl:"app/article/reply.directive.html",replace:!0,link:function(n,o,i){n.delReply=function(o,i,l){confirm("你确定要删除这条回复吗?")&&t.delReply(i,{rid:o}).then(function(t){e.debug(t),n.commentList[l]=t.data})["catch"](function(t){t=t.data.error_msg||"删除回复失败.",a.pop("error","",t)})}}}}])}(),function(){"use strict";angular.module("jackblog.article").directive("comment",["$rootScope","Comment","$timeout","$log","toaster","Auth",function(t,e,a,n,o,i){return{restrict:"E",templateUrl:"app/article/comment.directive.html",replace:!0,link:function(n,l,s){n.showReply=function(e,o){i.isLoggedInAsync(function(i){i?(n.isReply=!n.isReply,$("#replyContent"+e).val("@"+o+" "),a(function(){$("#replyContent"+e).focus()},0,!1)):t.opneSnsModal()})},n.submitNewReply=function(t,a,i){e.addNewReply(t,{content:a}).then(function(t){n.commentList[i].replys=t.data,n.isReply=!n.isReply})["catch"](function(t){t=t.data.error_msg||"添加回复失败.",o.pop("error","",t)})},n.delComment=function(t,a){confirm("删除评论会一起删除它所有回复,你确定要删除吗?")&&e.delComment({id:a}).then(function(){n.commentList.splice(t,1),o.pop("success","","删除评论成功.")})["catch"](function(t){t=t.data.error_msg||"删除评论失败.",o.pop("error","",t)})}}}}])}(),function(){"use strict";angular.module("jackblog.article").controller("ArticleCtrl",["$rootScope","$scope","$log","$state","$location","lodash","toaster","Auth","Blog","Comment","$stateParams",function(t,e,a,n,o,i,l,s,r,c,d){e.aid=d.aid,e.aid||n.go("blogList"),e.isAdmin=s.isAdmin,e.isLoggedIn=s.isLoggedIn,r.getFrontArticle({id:e.aid}).then(function(t){e.article=t.data}).then(function(){var t={id:e.aid,sortName:"publish_time",tagId:""};localStorage.options&&(t=i.merge(t,JSON.parse(localStorage.options))),r.getPrenext(t).then(function(t){e.next=t.data.next||{},e.prev=t.data.prev||{}})})["catch"](function(){n.go("blogList")}),c.getFrontCommentList({id:e.aid}).then(function(t){e.commentList=t.data})["catch"](function(t){a.debug(t),e.commentList=[]}),s.isLoggedInAsync(function(t){t?e.isLike=s.isLike(e.aid):e.isLike=!1}),e.newComment={content:""},e.submitNewComment=function(t){e.newComment.aid=t,c.addNewComment(e.newComment).then(function(t){e.commentList.push(t.data),e.newComment.content=""})["catch"](function(t){a.debug(t),l.pop("error","","评论添加错误,请重试.")})},e.goToComment=function(e){s.isLoggedInAsync(function(a){a?$("#"+e).focus():t.opneSnsModal()})},e.toggleLike=function(a){s.isLoggedInAsync(function(n){n?r.toggleLike({id:a}).then(function(t){e.article.like_count=t.count,e.isLike=t.isLike}):t.opneSnsModal()})}}])}(),function(){return angular.module("jackblog").constant("ServerUrl","https://api.jackhu.top").constant("IsDebug",!1).constant("CookieConfig",{domain:".jackhu.top"})}(),angular.module("jackblog").run(["$templateCache",function(t){t.put("app/article/article.html",'<div ng-include="\'app/components/navbar/navbar.html\'"></div><div class="article-box"><div class="article-container"><h1 class="title">{{article.title}}</h1><div class="counts"><span class="views-count">阅读{{article.visit_count}}</span> <span class="comments-count">评论{{article.comment_count}}</span> <span class="likes-count">喜欢{{article.like_count}}</span></div><div class="markdown-content" ng-bind-html="article.content"></div></div><div class="article-share clearfix"><a href="javascript:;" class="like-btn" ng-class="{\'note-liked\':isLike}" ng-click="toggleLike(article._id)"><span class="like-content"><i class="fa" ng-class="{\'fa-heart-o\':!isLike,\'fa-heart\':isLike}"></i> 喜欢</span> <span class="like-count">{{article.like_count}}</span></a></div><div class="prenext"><div class="text-left prev"><a ng-if="prev._id" class="link-title" ui-sref="article({aid:prev._id})"><span>上一篇:</span> {{prev.title}}</a></div><div class="text-right next"><a ng-if="next._id" class="link-title" ui-sref="article({aid:next._id})"><span>下一篇:</span> {{next.title}}</a></div></div><div class="comment-container clearfix"><div class="comment-head clearfix">{{commentList.length || 0}}条评论 <a href="javascript:void(null)" ng-click="goToComment(\'comment_content\')" class="goto-comment pull-right"><i class="fa fa-pencil"></i>添加新评论</a></div><div id="comment_list"><comment ng-repeat="comment in commentList"></comment></div><div ng-if="!isLoggedIn()"><p class="comment-signin"><button class="btn btn-info" ng-click="opneSnsModal()">登录后发表评论</button></p></div><form ng-if="isLoggedIn()" class="new_comment" name="new_comment"><div class="comment-text"><textarea maxlength="2000" required="" ng-model="newComment.content" placeholder="写下你的评论…" id="comment_content"></textarea><div><input type="submit" ng-click="submitNewComment(article._id)" ng-disabled="new_comment.$invalid" id="comment_submit_btn" value="发 表" class="btn btn-info"></div></div></form></div><scrolltop></scrolltop></div><div ng-include="\'app/components/footer/footer.html\'"></div>'),t.put("app/article/comment.directive.html",'<div class="comment-item"><div class="content"><div class="meta-top"><a class="avatar"><img ng-src="{{comment.user_id.avatar || default_avatar}}" alt="{{comment.user_id.nickname}}"></a> <a class="author-name link-light">{{comment.user_id.nickname}}</a> <span class="reply-time">{{comment.created | date:\'yyyy.MM.dd hh:mm\'}}</span></div><p class="comment-content">{{comment.content}}</p><div class="comment-footer text-right"><a class="delete" ng-if="isAdmin()" href="javascript:;" ng-click="delComment($index,comment._id)">删除</a> <a class="reply" href="javascript:void(0)" ng-click="showReply($index,comment.user_id.nickname)">回复</a></div><div class="reply-list" ng-init="isReply = false" ng-show="comment.replys.length > 0 || isReply"><reply ng-repeat="reply in comment.replys track by $index"></reply><form class="new-reply" ng-show="isReply"><div class="comment-text"><textarea id="replyContent{{$index}}" ng-model="replyContent" maxlength="2000" placeholder="写下你的回复…"></textarea><div><input type="button" ng-click="submitNewReply(comment._id,replyContent,$index)" value="发 表" id="reply_submit_btn_{{$index}}" class="btn btn-sm btn-info"></div></div></form></div></div></div>'),t.put("app/article/reply.directive.html",'<div class="reply-item"><p class="reply-content"><a class="reply-user link-light">{{reply.user_info.nickname}}</a>： {{reply.content}}</p><div class="reply-footer text-right"><a class="delete" ng-if="isAdmin()" href="javascript:;" ng-click="delReply(reply._id,comment._id,$parent.$parent.$index)">删除</a> <a class="reply" href="javascript:void(null)" ng-click="showReply($parent.$index,reply.user_info.nickname)">回复</a> <span class="reply-time pull-left">{{reply.created | date:\'yyyy.MM.dd hh:mm\'}}</span></div></div>'),
t.put("app/manage_blog/blog_edit.html",'<div ng-include="\'app/components/navbar/navbar.html\'"></div><div class="manage-box"><div class="manage-container write-blog"><h1 class="text-center">编辑博客</h1><hr><form class="write-blog-form" name="writeBlogForm" method="post" novalidate=""><div class="form-group"><label>标题</label> <input type="text" class="form-control" required="" ng-model="article.title" placeholder="标题"></div><div class="form-group"><label>添加标签</label><div class="row"><div class="col-xs-6"><select class="form-control" ng-model="tag" ng-options="tag as tag.name group by tag.cid.name for tag in tagList"><option value="">--请选择--</option></select></div><div class="col-xs-6"><button type="button" ng-click="addTag(tag)" class="btn btn-primary btn-block">添加</button></div></div></div><div class="form-group"><label>标签列表(双击删除)</label><div class="select-tags"><button type="button" class="btn btn-warning" ng-dblclick="delTag(key)" ng-repeat="(key, value) in article.tags">{{value.name}}</button></div></div><div class="form-group"><label>图片列表 <button type="button" ng-click="addImages()" class="btn btn-primary">添加图片</button></label> <input type="text" class="form-control show-image-url" ng-model="selectImageUrl"><div class="select-images"><div class="col-md-3 col-sm-4 col-xs-6 image-list" ng-repeat="image in article.images"><img ng-click="showUrl(image.url)" ng-src="{{image.url}}"> <button type="button" class="btn btn-default btn-sm" ng-click="showUrl(image.url)">显示URL</button> <button type="button" class="btn btn-default btn-sm" ng-click="delImage($index)">删除</button></div></div></div><div class="form-group"><label>内容</label><div><textarea id="some-textarea" class="form-control" ng-model="article.content" required="" markdowneditor="" rows="15"></textarea></div></div><div class="form-group"><label class="control-label">是否置顶</label><div><label class="radio-inline"><input type="radio" ng-model="article.top" ng-value="true"> 是</label> <label class="radio-inline"><input type="radio" ng-model="article.top" ng-value="false"> 否</label></div></div><div class="form-group"><label class="control-label">状态</label><div><label class="radio-inline"><input type="radio" ng-model="article.status" ng-value="1"> 已发布</label> <label class="radio-inline"><input type="radio" ng-model="article.status" ng-value="0"> 草稿</label></div></div><p><a ng-disabled="writeBlogForm.$invalid" class="btn btn-default btn-lg" ui-sref="article({aid:article._id})" target="_blank">预览</a> <button type="button" ng-disabled="writeBlogForm.$invalid" class="btn btn-info btn-lg" ng-click="save()">保存</button> <button type="button" ng-disabled="writeBlogForm.$invalid" class="btn btn-info btn-lg" ng-click="save(\'isRePub\')">保存并重新发布</button></p></form></div></div>'),t.put("app/manage_blog/blog_images_add.html",'<div class="modal-header"><h3 class="modal-title">添加图片</h3></div><div class="modal-body"><div class="portlet-body form"><form name="addForm" class="form-horizontal" novalidate=""><div class="form-body"><div class="text-center" style="padding: 5px;"><a href="" ng-click="type=\'local\'">本地上传</a>或<a href="" ng-click="type=\'online\'">网络图片</a></div><div class="form-group"><div class="col-md-12"><input type="text" required="" autocomplete="off" ng-show="type===\'online\'" ng-model="url" class="form-control" placeholder="图片链接"> <button ng-show="type===\'local\'" class="btn btn-info btn-block" accept="image/*" ngf-select="uploadImg($file, $invalidFiles)" ngf-max-size="2MB">选择本地图片</button></div></div></div></form></div></div><div class="modal-footer"><button class="btn btn-primary" ng-show="type===\'online\'" ng-disabled="addForm.$invalid" ng-click="fetchImg()">OK</button> <button class="btn btn-warning" ng-click="cancel()">Cancel</button></div>'),t.put("app/manage_blog/blog_list.html",'<div ng-include="\'app/components/navbar/navbar.html\'"></div><div class="manage-box"><div class="manage-container blog-manage"><h1 class="text-center">博客管理-文章列表</h1><hr><div class="table-toolbar"><div class="btn-group"><button class="btn btn-primary" ui-sref="blogWrite()">写博客 <i class="fa fa-pencil"></i></button></div><div class="btn-group pull-right"><div class="dataTables_filter"><input type="text" placeholder="搜索" ng-model="q" class="form-control input-medium"></div></div></div><div class="portlet-body table-responsive"><table class="table table-striped table-bordered table-hover table-condensed"><thead><tr><th>标题</th><th>标签数</th><th ng-click="changeSort(\'visit_count\')" class="sorting">访问数 <span ng-class="{\'icon-sort-asc\':(options.sortName === \'visit_count\' && options.sortOrder),\'icon-sort-desc\':(options.sortName === \'visit_count\' && !options.sortOrder),\'icon-sort-both\':(options.sortName !== \'visit_count\')}"></span></th><th>评论数</th><th>喜欢数</th><th>是否置顶</th><th>状态</th><th>创建时间</th><th>最后更新时间</th><th ng-click="changeSort(\'publish_time\')" class="sorting">发布时间 <span ng-class="{\'icon-sort-asc\':(options.sortName === \'publish_time\' && options.sortOrder),\'icon-sort-desc\':(options.sortName === \'publish_time\' && !options.sortOrder),\'icon-sort-both\':(options.sortName !== \'publish_time\')}"></span></th><th class="text-center">管理</th></tr></thead><tbody><tr class="odd gradeX" ng-repeat="blog in blogList | filter:q track by $index"><td><a ui-sref="article({aid:blog._id})" target="_blank">{{blog.title}}</a></td><td><span>{{blog.tags.length}}</span></td><td>{{blog.visit_count}}</td><td>{{blog.comment_count}}</td><td>{{blog.like_count}}</td><td><i class="fa fa-check text-success" ng-show="tag.is_index"></i> <i class="fa fa-times text-danger" ng-show="!tag.is_index"></i></td><td><span ng-show="blog.status">已发布</span> <span ng-show="!blog.status">草稿</span></td><td>{{blog.created | date:\'short\'}}</td><td>{{blog.updated | date:\'short\'}}</td><td>{{blog.publish_time | date:\'short\'}}</td><td class="text-center"><a ui-sref="blogEdit({aid:blog._id})">Edit</a>&nbsp;&nbsp; <a class="delete-btn" href="" ng-click="del(blog)">Delete</a>&nbsp;&nbsp; <a ui-sref="article({aid:blog._id})" target="_blank">查看文章</a></td></tr></tbody></table></div><div class="row"><div class="col-sm-5 col-xs-12"><div class="dataTables_info">Page: {{options.currentPage}} / {{numPages}} of {{bigTotalItems}}</div></div><div class="col-sm-7 col-xs-12"><pagination ng-change="pageChanged()" total-items="bigTotalItems" ng-model="options.currentPage" max-size="maxSize" items-per-page="options.itemsPerPage" class="pagination-md pull-right" boundary-links="true" rotate="false" num-pages="numPages"></pagination></div></div></div></div>'),t.put("app/manage_blog/blog_write.html",'<div ng-include="\'app/components/navbar/navbar.html\'"></div><div class="manage-box"><div class="manage-container write-blog"><h1 class="text-center">开始写博客</h1><hr><form class="write-blog-form" name="writeBlogForm" method="post" novalidate=""><div class="form-group"><label>标题</label> <input type="text" class="form-control" required="" ng-model="article.title" placeholder="标题"></div><div class="form-group"><label>添加标签</label><div class="row"><div class="col-xs-6"><select class="form-control" ng-model="tag" ng-options="tag as tag.name group by tag.cid.name for tag in tagList"><option value="">--请选择--</option></select></div><div class="col-xs-6"><button type="button" ng-click="addTag(tag)" class="btn btn-primary btn-block add-tag-btn">添加</button></div></div></div><div class="form-group"><label>标签列表(双击删除)</label><div class="select-tags"><button type="button" class="btn btn-warning" ng-dblclick="delTag(key)" ng-repeat="(key, value) in article.tags">{{value.name}}</button></div></div><div class="form-group"><label>图片列表 <button type="button" ng-click="addImages()" class="btn btn-primary">添加图片</button></label> <input type="text" class="form-control show-image-url" ng-model="selectImageUrl"><div class="select-images"><div class="col-md-3 col-sm-4 col-xs-6 image-list" ng-repeat="image in images"><img ng-click="showUrl(image.url)" ng-src="{{image.url}}"> <button type="button" class="btn btn-default btn-sm" ng-click="showUrl(image.url)">显示URL</button> <button type="button" class="btn btn-default btn-sm" ng-click="delImage($index)">删除</button></div></div></div><div class="form-group"><label>内容</label><div><textarea class="form-control" ng-model="article.content" required="" markdowneditor="" rows="15"></textarea></div></div><div class="form-group"><label class="control-label">是否置顶</label><div><label class="radio-inline"><input type="radio" ng-model="article.top" ng-value="true"> 是</label> <label class="radio-inline"><input type="radio" ng-model="article.top" ng-value="false"> 否</label></div></div><p><button type="button" ng-disabled="writeBlogForm.$invalid" class="btn btn-default btn-lg" ng-click="preview()">预览</button> <button type="button" ng-disabled="writeBlogForm.$invalid" class="btn btn-info btn-lg" ng-click="save()">保存为草稿</button> <button type="button" ng-disabled="writeBlogForm.$invalid" class="btn btn-primary btn-lg" id="save_pub_btn" ng-click="save(1)">保存并发布</button></p></form></div></div>'),t.put("app/manage_tag/tag_add.html",'<div class="modal-header"><h3 class="modal-title">添加标签</h3></div><div class="modal-body"><div class="portlet-body form"><form name="addForm" class="form-horizontal webSettingForm" novalidate=""><div class="form-body"><div class="form-group"><label class="control-label col-md-4">标签名 <span class="required">*</span></label><div class="col-md-6"><input type="text" autocomplete="off" ng-model="tag.name" required="" class="form-control"></div></div><div class="form-group"><label class="col-md-4 control-label">选择分类 <span class="required">*</span></label><div class="col-md-6"><select class="form-control" ng-model="tag.cid" ng-options="cat._id as cat.name for cat in catList"><option value="">--请选择--</option></select></div></div><div class="form-group"><label class="control-label col-md-4">排序</label><div class="col-md-6"><input type="number" autocomplete="off" ng-model="tag.sort" required="" class="form-control"></div></div><div class="form-group"><label class="control-label col-md-4">是否显示</label><div class="col-md-8"><label class="radio-inline"><input type="radio" ng-model="tag.is_show" ng-value="true"> 是</label> <label class="radio-inline"><input type="radio" ng-model="tag.is_show" ng-value="false"> 否</label></div></div><div class="form-group"><label class="control-label col-md-4">是否显示在首页</label><div class="col-md-8"><label class="radio-inline"><input type="radio" ng-model="tag.is_index" ng-value="true"> 是</label> <label class="radio-inline"><input type="radio" ng-model="tag.is_index" ng-value="false"> 否</label></div></div></div></form></div></div><div class="modal-footer"><button class="btn btn-primary" ng-disabled="addForm.$invalid" ng-click="ok(addForm)">OK</button> <button class="btn btn-warning" ng-click="cancel()">Cancel</button></div>'),t.put("app/manage_tag/tag_cat_add.html",'<div class="modal-header"><h3 class="modal-title">添加标签分类</h3></div><div class="modal-body"><div class="portlet-body form"><form name="addForm" class="form-horizontal webSettingForm" novalidate=""><div class="form-body"><div class="form-group"><label class="control-label col-md-4">分类名 <span class="required">*</span></label><div class="col-md-6"><input type="text" autocomplete="off" ng-model="cat.name" required="" class="form-control"></div></div><div class="form-group"><label class="control-label col-md-4">分类描述</label><div class="col-md-6"><textarea name="cat_desc" ng-model="cat.desc" rows="6" cols="28" class="form-control"></textarea></div></div></div></form></div></div><div class="modal-footer"><button class="btn btn-primary" ng-disabled="addForm.$invalid" ng-click="ok(addForm)">OK</button> <button class="btn btn-warning" ng-click="cancel()">Cancel</button></div>'),t.put("app/manage_tag/tag_cat_edit.html",'<div class="modal-header"><h3 class="modal-title">编辑标签分类</h3></div><div class="modal-body"><div class="portlet-body form"><form name="addForm" class="form-horizontal webSettingForm" novalidate=""><div class="form-body"><div class="form-group"><label class="control-label col-md-4">分类名 <span class="required">*</span></label><div class="col-md-6"><input type="text" autocomplete="off" ng-model="cat.name" required="" class="form-control"></div></div><div class="form-group"><label class="control-label col-md-4">分类描述</label><div class="col-md-6"><textarea name="cat_desc" ng-model="cat.desc" rows="6" cols="28" class="form-control"></textarea></div></div></div></form></div></div><div class="modal-footer"><button class="btn btn-primary" ng-disabled="addForm.$invalid" ng-click="ok(addForm)">OK</button> <button class="btn btn-warning" ng-click="cancel()">Cancel</button></div>'),t.put("app/manage_tag/tag_edit.html",'<div class="modal-header"><h3 class="modal-title">编辑标签</h3></div><div class="modal-body"><div class="portlet-body form"><form name="addForm" class="form-horizontal webSettingForm" novalidate=""><div class="form-body"><div class="form-group"><label class="control-label col-md-4">标签名 <span class="required">*</span></label><div class="col-md-6"><input type="text" autocomplete="off" ng-model="tag.name" required="" class="form-control"></div></div><div class="form-group"><label class="col-md-4 control-label">选择分类 <span class="required">*</span></label><div class="col-md-6"><select class="form-control" ng-model="tag.cid._id" ng-options="cat._id as cat.name for cat in catList"><option value="">--请选择--</option></select></div></div><div class="form-group"><label class="control-label col-md-4">排序</label><div class="col-md-6"><input type="number" autocomplete="off" ng-model="tag.sort" required="" class="form-control"></div></div><div class="form-group"><label class="control-label col-md-4">是否显示</label><div class="col-md-8"><label class="radio-inline"><input type="radio" ng-model="tag.is_show" ng-value="true"> 是</label> <label class="radio-inline"><input type="radio" ng-model="tag.is_show" ng-value="false"> 否</label></div></div><div class="form-group"><label class="control-label col-md-4">是否显示在首页</label><div class="col-md-8"><label class="radio-inline"><input type="radio" ng-model="tag.is_index" ng-value="true"> 是</label> <label class="radio-inline"><input type="radio" ng-model="tag.is_index" ng-value="false"> 否</label></div></div></div></form></div></div><div class="modal-footer"><button class="btn btn-primary" ng-disabled="addForm.$invalid" ng-click="ok(addForm)">OK</button> <button class="btn btn-warning" ng-click="cancel()">Cancel</button></div>'),t.put("app/manage_tag/tags_list.html",'<div ng-include="\'app/components/navbar/navbar.html\'"></div><div class="manage-box"><div class="manage-container tags-manage"><h1 class="text-center">标签管理-标签列表</h1><hr><div class="table-toolbar"><div class="btn-group"><button class="btn btn-primary" ng-click="add()">添加标签 <i class="fa fa-plus"></i></button></div><div class="btn-group pull-right" dropdown="" is-open="status.isopena"><select ng-change="changeCat()" class="form-control" ng-model="cid" ng-options="cat._id as cat.name for cat in catList"><option value="">--全部标签--</option></select></div></div><div class="portlet-body table-responsive"><table class="table table-striped table-bordered table-hover table-condensed"><thead><tr><th>标签名</th><th>所属分类</th><th>排序</th><th>是否显示</th><th>是否首页</th><th class="text-center">管理</th></tr></thead><tbody><tr class="odd gradeX" ng-repeat="tag in tagList"><td><span>{{tag.name}}</span></td><td><span>{{tag.cid.name}}</span></td><td>{{tag.sort}}</td><td><i class="fa fa-check text-success" ng-show="tag.is_show"></i> <i class="fa fa-times text-danger" ng-show="!tag.is_show"></i></td><td><i class="fa fa-check text-success" ng-show="tag.is_index"></i> <i class="fa fa-times text-danger" ng-show="!tag.is_index"></i></td><td class="text-center"><a href="" ng-click="edit(tag)">Edit</a>&nbsp;&nbsp; <a href="" ng-click="del(tag)">Delete</a></td></tr></tbody></table></div></div></div>'),t.put("app/manage_tag/tags_manage.html",'<div ng-include="\'app/components/navbar/navbar.html\'"></div><div class="manage-box"><div class="manage-container tag-cat-manage"><h1 class="text-center">标签管理-分类列表</h1><hr><div class="table-toolbar"><div class="btn-group"><button class="btn btn-primary" ng-click="add()">添加标签分类 <i class="fa fa-plus"></i></button></div></div><div class="portlet-body table-responsive"><table class="table table-striped table-bordered table-hover table-condensed"><thead><tr><th>分类名</th><th>描述</th><th class="text-center">管理</th></tr></thead><tbody><tr class="odd gradeX" ng-repeat="cat in catList"><td><a ui-sref="tagsList({cid:cat._id})">{{cat.name}}</a></td><td><span>{{cat.desc}}</span></td><td class="text-center"><a href="" ng-click="edit(cat)">Edit</a>&nbsp;&nbsp; <a href="" ng-click="del(cat)">Delete</a></td></tr></tbody></table></div></div></div>'),t.put("app/manage_user/user_add.html",'<div class="modal-header"><h3 class="modal-title">Add User</h3></div><div class="modal-body"><div class="portlet-body form"><form name="addUserForm" class="form-horizontal" novalidate=""><div class="form-body"><div class="form-group"><label class="control-label col-md-4">Nick Name <span class="required">*</span></label><div class="col-md-6"><input type="text" placeholder="呢称" autocomplete="off" ng-model="user.nickname" required="" class="form-control"></div></div><div class="form-group"><label class="control-label col-md-4">Email <span class="required">*</span></label><div class="col-md-6"><input type="email" placeholder="邮箱" autocomplete="off" ng-model="user.email" required="" class="form-control"></div></div><div class="form-group"><label class="control-label col-md-4">Password <span class="required">*</span></label><div class="col-md-6"><input type="password" placeholder="密码" autocomplete="off" ng-model="user.password" required="" class="form-control"></div></div><div class="form-group"><label class="control-label col-md-4">Status <span class="required">*</span></label><div class="col-md-8"><label class="radio-inline"><input type="radio" ng-model="user.status" value="1"> Authenticated</label> <label class="radio-inline"><input type="radio" ng-model="user.status" value="0"> Unverified</label> <label class="radio-inline"><input type="radio" ng-model="user.status" value="2"> Blocked</label></div></div></div></form></div></div><div class="modal-footer"><button class="btn btn-primary" ng-disabled="addUserForm.$invalid" ng-click="ok(addUserForm)">OK</button> <button class="btn btn-warning" ng-click="cancel()">Cancel</button></div>'),t.put("app/manage_user/user_edit.html",'<div class="modal-header"><h3 class="modal-title">Edit User</h3></div><div class="modal-body"><div class="portlet-body form"><form name="editUserForm" class="form-horizontal" novalidate=""><div class="form-body"><div class="form-group"><label class="control-label col-md-4">Nick Name <span class="required">*</span></label><div class="col-md-6"><input type="text" required="" autocomplete="off" ng-model="currentUser.nickname" class="form-control"></div></div><div class="form-group"><label class="control-label col-md-4">Email</label><div class="col-md-6"><input type="email" autocomplete="off" ng-model="currentUser.email" class="form-control"></div></div><div class="form-group"><label class="control-label col-md-4">是否修改密码(可选)</label><div class="col-md-6"><input type="password" autocomplete="off" ng-model="currentUser.newPassword" class="form-control"></div></div><div class="form-group"><label class="control-label col-md-4">Status <span class="required">*</span></label><div class="col-md-8"><label class="radio-inline"><input type="radio" ng-model="currentUser.status" value="1"> Authenticated</label> <label class="radio-inline"><input type="radio" ng-model="currentUser.status" value="0"> Unverified</label> <label class="radio-inline"><input type="radio" ng-model="currentUser.status" value="2"> Blocked</label></div></div></div></form></div></div><div class="modal-footer"><button class="btn btn-primary" ng-disabled="editUserForm.$invalid" ng-click="ok(editUserForm)">OK</button> <button class="btn btn-warning" ng-click="cancel()">Cancel</button></div>'),t.put("app/manage_user/user_list.html",'<div ng-include="\'app/components/navbar/navbar.html\'"></div><div class="manage-box"><div class="manage-container user-manage"><h1 class="text-center">用户管理-用户列表</h1><hr><div class="table-toolbar"><div class="btn-group"><button class="btn btn-primary" ng-click="add()">增加用户 <i class="fa fa-plus"></i></button></div><div class="btn-group pull-right"><div class="dataTables_filter"><input type="text" placeholder="搜索" ng-model="q" class="form-control input-medium"></div></div></div><div class="portlet-body table-responsive"><table class="table table-striped table-bordered table-hover table-condensed"><thead><tr><th>呢称</th><th>Email</th><th>角色</th><th>状态</th><th>注册方式</th><th>注册时间</th><th>更新时间</th><th class="text-center">管理</th></tr></thead><tbody><tr class="odd gradeX" ng-repeat="user in userList | filter:q"><td><span>{{user.nickname}}</span></td><td><span>{{user.email}}</span></td><td><span>{{user.role}}</span></td><td><span class="label label-sm" ng-class="{\'label-success\': (user.status == 1),\'label-warning\':(user.status == 0),\'label-default\':(user.status == 2)}">{{user.status | userStatus}}</span></td><td>{{user.provider}}</td><td>{{user.created | date:\'short\'}}</td><td>{{user.updated | date:\'short\'}}</td><td class="text-center"><a href="" ng-click="edit(user)">Edit</a>&nbsp;&nbsp; <a href="" ng-click="del(user)">Delete</a></td></tr></tbody></table></div><div class="row"><div class="col-sm-5 col-xs-12"><div class="dataTables_info">Page: {{options.currentPage}} / {{numPages}} of {{bigTotalItems}}</div></div><div class="col-sm-7 col-xs-12"><pagination ng-change="pageChanged()" total-items="bigTotalItems" ng-model="options.currentPage" max-size="maxSize" items-per-page="options.itemsPerPage" class="pagination-md pull-right" boundary-links="true" rotate="false" num-pages="numPages"></pagination></div></div></div></div>'),t.put("app/settings/local_sign_in.html",'<div ng-include="\'app/components/navbar/navbar.html\'"></div><div class="signin-box"><div class="signin-container"><h4 class="title">登 录</h4><form class="signin-form form-horizontal" name="signinForm" ng-submit="login(signinForm)" ng-keypress="loginPress($event,signinForm)" novalidate=""><div class="form-group"><div class="input-group"><div class="input-group-addon"><i class="fa fa-envelope-o"></i></div><input type="text" required="" email="" ng-minlength="3" ng-maxlength="30" ng-model="user.email" class="form-control" placeholder="邮箱"></div></div><div class="form-group"><div class="input-group"><div class="input-group-addon"><i class="fa fa-unlock-alt"></i></div><input type="password" required="" ng-model="user.password" class="form-control" placeholder="密码"></div></div><div class="form-group"><div class="col-xs-6 captcha-code"><input class="form-control" required="" maxlength="6" type="text" name="captcha" ng-model="user.captcha" placeholder="验证码"></div><div class="col-xs-6 captcha-img"><a href="javascript:;" ng-click="changeCaptcha()"><img ng-src="{{captchaUrl}}"></a></div></div><div class="form-group"><button class="btn btn-primary btn-lg btn-block" type="submit" ng-disabled="signinForm.$invalid" id="signin_btn">登 录</button></div></form><div class="login-sns"><p>您还可以通过以下方式直接登录</p><snsloginbtns></snsloginbtns></div></div></div>'),t.put("app/settings/sns_login_btn.html",'<ul><li ng-click="loginOauth(item)" ng-repeat="item in loginBtns"><a class="{{item}}" href="javascript:;"><i class="fa fa-{{item}}"></i></a></li></ul>'),t.put("app/settings/sns_sign_in.html",'<div class="modal-header"><h4 class="modal-title text-center">请用以下方式登录</h4></div><div class="modal-body"><div class="portlet-body"><div class="login-sns"><snsloginbtns></snsloginbtns></div></div></div>'),t.put("app/settings/user_setting.html",'<div ng-include="\'app/components/navbar/navbar.html\'"></div><div class="settings-box"><div class="settings-container"><h2 class="title">设置</h2><hr><div class="profile"><div class="control-group"><form class="settings-form" name="settingForm" ng-submit="mdUser(settingForm)" novalidate=""><div class="form-group"><label class="control-label">昵称</label> <input placeholder="2-15字符，中英文、数字和下划线" required="" nickname="" type="text" class="form-control" ng-minlength="2" ng-maxlength="15" ng-model="user.nickname"></div><button type="submit" class="btn btn-block btn-lg btn-primary" ng-disabled="settingForm.$invalid">保 存</button></form></div></div></div></div>'),t.put("app/components/footer/footer.html",'<footer ng-controller="FooterCtrl"><div class="footer-container"><ul><li><span>{{beian}}</span></li><li><a class="github" href="https://github.com/jackhutu/jackblog-admin" target="_blank"><i class="fa fa-github"></i></a></li><li><a class="weibo" href="http://weibo.com/hutaigong" target="_blank"><i class="fa fa-weibo"></i></a></li></ul></div></footer>'),t.put("app/components/navbar/navbar.html",'<div class="navbar-box navbar-skin" ng-controller="NavbarCtrl"><div class="navbar-menu"><a class="navbar-item logo" ng-class="{active: isActive(\'/\')}" title="首页" href="/">Hu</a></div><div class="navbar-expanded"><div ng-if="isAdmin()"><a class="navbar-item" ui-sref-active="active" ui-sref="userList()" tooltip-placement="right" tooltip-class="nav-tooltip" tooltip="用户管理"><i class="fa fa-users"></i></a> <a class="navbar-item" ui-sref-active="active" ui-sref="blogList()" tooltip-placement="right" tooltip-class="nav-tooltip" tooltip="文章管理"><i class="fa fa-book"></i></a> <a class="navbar-item" ui-sref-active="active" ui-sref="tagsManage()" tooltip-placement="right" tooltip-class="nav-tooltip" tooltip="标签管理"><i class="fa fa-tags"></i></a></div><div><a class="navbar-item change-mode" href="javascript:;" ng-click="changeMode()" tooltip-placement="right" tooltip-class="nav-tooltip" tooltip="模式切换"><i ng-if="dayMode" class="fa fa-moon-o"></i> <i ng-if="!dayMode" class="fa fa-sun-o"></i></a></div><div ng-if="isLoggedIn()"><a href="javascript:;" class="navbar-item expanded-logout" ng-click="logout()" tooltip-class="nav-tooltip" tooltip-placement="right" tooltip="登出"><i class="fa fa-sign-out"></i></a> <a class="navbar-item expanded-avatar" ui-sref="setting()" tooltip-class="nav-tooltip" tooltip-placement="right" tooltip="{{getCurrentUser().nickname}}"><img ng-src="{{ getCurrentUser().avatar || default_avatar}}"></a></div><div ng-if="!isLoggedIn()"><a class="navbar-item" ui-sref-active="active" ui-sref="signin()" tooltip-class="nav-tooltip" tooltip-placement="right" tooltip="登录"><i class="fa fa-sign-in"></i></a></div></div><div class="navbar-shrink"><div ng-if="isLoggedIn()" class="pull-right" dropdown="" is-open="status.isopen"><a href="javascript:;" class="shrink-avatar dropdown-toggle" data-toggle="dropdown" dropdown-toggle="" ng-disabled="disabled"><img ng-src="{{ getCurrentUser().avatar || default_avatar}}"></a><ul class="dropdown-menu" role="navbarList"><li ng-if="isAdmin()"><a href="/user_list"><i class="fa fa-users"></i> 用户管理</a> <a href="/blog_list"><i class="fa fa-book"></i> 文章管理</a> <a href="/tags_manage"><i class="fa fa-tags"></i> 标签管理</a></li><li><a ui-sref="setting()"><i class="fa fa-cog"></i> 设置</a></li><li class="divider"></li><li><a href="javascript:;" class="shrink-logout" ng-click="logout()"><i class="fa fa-sign-out"></i> 登出</a></li></ul></div><div ng-if="!isLoggedIn()" class="pull-right"><a class="shrink-login" ui-sref="signin()"><i class="fa fa-sign-in"></i> 登录</a></div><div class="pull-right"><a class="navbar-item change-mode" href="javascript:;" ng-click="changeMode()"><i ng-if="dayMode" class="fa fa-moon-o"></i> <i ng-if="!dayMode" class="fa fa-sun-o"></i></a></div></div></div>')}]);